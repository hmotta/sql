select s.clavesocioint,ts.descritiposocio as tipo_socio, su.nombre,su.paterno,su.materno, su.rfc,su.curp, si.ocupacion,si.profesion,(case when si.nivelestudiosid=0 then 'Ninguno' else (case when si.nivelestudiosid=1 then 'Primaria' else (case when si.nivelestudiosid=2 then 'Secundaria' else (case when si.nivelestudiosid=3 then 'Preparatoria' else (case when si.nivelestudiosid=4 then 'Licenciatura'   else (case when si.nivelestudiosid=5 then 'Maestria' else 'doctorado' end) end)end)end) end ) end) as nivelestudios,  sexo(si.sexo), su.fecha_nacimiento, estadocivil(si.estadocivilid) as Estado_Civil, si.fechaingreso as Fecha_ingreso,s.fechabaja as fechabaja,d.codpostal,es.nombreestadomex as estado,cd.nombreciudadmex as comunidad,c.nombrecolonia as colonia, d.calle,d.numero_ext,d.numero_int,d.teldomicilio,(case when si.tipocasaid=0 then 'Rentada' else (case when si.tipocasaid=1 then 'Propia' else (case when si.tipocasaid=2 then 'Familiar' else (case when si.tipocasaid=3 then 'Compartida' else 'Otra' end) end) end ) end) as tipocasa,(select coalesce((select max(tipoderiesgoid) from  matrizclientes mc, tipoderiesgo tr where (promedio between nivelderiesgo and nivelderiesgomax) and socioid=s.socioid),3) from conoceatucliente where sujetoid=su.sujetoid) from socio s, sujeto su, domicilio d,colonia c,tiposocio ts, ciudadesmex cd, estadosmex es, solicitudingreso si where s.sujetoid = su.sujetoid and su.sujetoid = d.sujetoid and d.coloniaid = c.coloniaid and d.ciudadmexid = cd.ciudadmexid and s.socioid = si.socioid   and s.tiposocioid=ts.tiposocioid and nombre<>'CAJA' and paterno<>'CAJA' and materno<>'CAJA' and cd.estadomexid  = es.estadomexid and  s.estatussocio<>2  order by s.clavesocioint ; 