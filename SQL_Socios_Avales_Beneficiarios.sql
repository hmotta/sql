select clavesocioint,su.nombre||' '||su.paterno||' '||su.materno as Nombre,(select count(*) from prestamos where socioid=s.socioid and claveestadocredito='001') as Créditos_Activos,(select count(*) from avales a, prestamos p where a.prestamoid=p.prestamoid and claveestadocredito='001' and a.socioid=s.socioid) as créditos_que_avala,(select (select count(*) from relacion where esbenficiario=1 and socioid=s.socioid) + (select count(*) from beneficiario b, inversion i where b.socioid=s.socioid and i.inversionid=b.inversionid and i.depositoinversion<>i.retiroinversion)) as Beneficiario from socio s,sujeto su where s.sujetoid=su.sujetoid and tiposocioid in ('02','05') and estatussocio in (1,3) group by s.clavesocioint,s.socioid,su.nombre,su.paterno,su.materno having saldomov(s.socioid,'PA',current_date)>=500;