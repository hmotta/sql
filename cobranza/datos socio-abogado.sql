select p.prestamoid,s.clavesocioint,su.nombre||' '||su.paterno||' '||su.materno as nombre,trim(p.referenciaprestamo),(select grupo from solicitudingreso where socioid=s.socioid) as grupo,tp.desctipoprestamo,(select count(*) from amortizaciones where (importeamortizacion-abonopagado)>0 and prestamoid=p.prestamoid and fechadepago <= current_date),(select current_date -min(fechadepago) from amortizaciones where abonopagado<>importeamortizacion and prestamoid=p.prestamoid) as diasdemora,(select abogado from abogado where abogadoid=ca.abogadoid),ca.expedienteentregado,ca.observaciones from prestamos p, socio s,sujeto su,tipoprestamo tp,carteraabogado ca where p.socioid=s.socioid and su.sujetoid=s.sujetoid and p.tipoprestamoid=tp.tipoprestamoid and claveestadocredito='001' and ca.prestamoid=p.prestamoid;